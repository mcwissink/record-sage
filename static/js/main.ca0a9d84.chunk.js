(this["webpackJsonpreact-records"]=this["webpackJsonpreact-records"]||[]).push([[0],{16:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),c=n(8),s=n.n(c),u=(n(16),n(0)),i=n.n(u),o=n(2),p=n(9),h=n.n(p),d=n(6),l=n(5),f=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,[{key:"connect",value:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("'connect' is not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("'disconnect' is not implemented");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"isAuthenticated",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"isConnected",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.isAuthenticated();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.isAuthenticated();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"schema",value:function(e){throw new Error("'schema' is not implemented")}},{key:"insert",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("'insert' is not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("'get' is not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),v=n(11),b=n(10),j=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gapi,a=arguments.length>1?arguments[1]:void 0;return Object(l.a)(this,n),(e=t.call(this)).api=r,e.initialized=a,e.insert=function(){var t=Object(o.a)(i.a.mark((function t(n,r){var a,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.getA1Notation(1,0),c=e.getA1Notation(1,r.length-1),t.next=4,e.api.client.sheets.spreadsheets.values.append({spreadsheetId:e.getSpreadsheetId(),valueInputOption:"USER_ENTERED",insertDataOption:"INSERT_ROWS",range:"".concat(n,"!").concat(a,":").concat(c),values:[r]});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.getRowCount=function(){var t=Object(o.a)(i.a.mark((function t(n){var r,a,c,s,u,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.api.client.sheets.spreadsheets.get({spreadsheetId:e.getSpreadsheetId()});case 3:return r=t.sent,a=r.body,c=JSON.parse(a),s=c.sheets,u=s.find((function(e){return e.properties.title===n})),o=u.properties,t.abrupt("return",o.gridProperties.rowCount-1);case 10:throw t.prev=10,t.t0=t.catch(0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),e.get=function(){var t=Object(o.a)(i.a.mark((function t(n){var r,a,c,s,u,o,p;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRowCount(n);case 2:if(!((r=t.sent)>0)){t.next=14;break}return a=e.getA1Notation(1,0),c=e.getA1Notation(1+r,e.schema(n).columns.length-1),t.next=8,e.api.client.sheets.spreadsheets.values.get({spreadsheetId:e.getSpreadsheetId(),range:"".concat(n,"!").concat(a,":").concat(c)});case 8:return s=t.sent,u=s.body,o=JSON.parse(u),p=o.values,t.abrupt("return",p);case 14:return t.abrupt("return",[]);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.initialized=new Promise((function(t,n){e.api.load("client:auth2",Object(o.a)(i.a.mark((function r(){return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.api.client.init({apiKey:"AIzaSyCNEjUa-oT-sppE2yix52q4KeudcJpdIXw",clientId:"794158492809-ukkr1lfsml3ghmclr4po0rfongru44dq.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/spreadsheets",discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"]});case 3:t(),r.next=10;break;case 6:r.prev=6,r.t0=r.catch(0),console.error(r.t0),n(r.t0);case 10:case"end":return r.stop()}}),r,null,[[0,6]])}))))})),e}return Object(d.a)(n,[{key:"getA1Notation",value:function(e,t){for(var r="",a=t+1;--a>=0;){var c=Math.floor(a/26),s=a%26;r=n.alphabet[s]+r,a=c}return"".concat(r).concat(e+1)}},{key:"getSchema",value:function(){var e=localStorage.getItem(n.spreadsheetSchemaKey);if(e)return JSON.parse(e);throw new Error("Failed to load schema")}},{key:"setSchema",value:function(e){return localStorage.setItem(n.spreadsheetSchemaKey,JSON.stringify(e))}},{key:"getSpreadsheetId",value:function(){return localStorage.getItem(n.spreadsheetIdKey)}},{key:"setSpreadsheetId",value:function(e){localStorage.setItem(n.spreadsheetIdKey,e)}},{key:"isAuthenticated",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initialized;case 2:return e.abrupt("return",this.api.auth2.getAuthInstance().isSignedIn.get());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isConnected",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initialized;case 2:return e.abrupt("return",Boolean(this.getSpreadsheetId()));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.auth2.getAuthInstance().signIn();case 2:return e.abrupt("return",this.isAuthenticated());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.auth2.getAuthInstance().signOut();case 2:return e.abrupt("return",this.isAuthenticated());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem(n.spreadsheetIdKey);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"schema",value:function(e){var t=this.getSchema(),n=t.find((function(t){return t.table===e}));if(n)return n;throw new Error("Table does not exist")}},{key:"connect",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r,a,c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("spreadsheetId"in t)){e.next=6;break}return e.next=3,this.api.client.sheets.spreadsheets.get({spreadsheetId:t.spreadsheetId});case 3:this.setSpreadsheetId(t.spreadsheetId),e.next=14;break;case 6:return this.setSchema(t.schema),n=t.schema.concat([{table:"SheetsTableData",columns:["table","count","sync"],rows:t.schema.map((function(e){var t,n=e.table,r=e.rows;return[n,null!==(t=null===r||void 0===r?void 0:r.length)&&void 0!==t?t:0,"full"]}))}]),e.next=10,this.api.client.sheets.spreadsheets.create({properties:{title:"Record Sage - ".concat((new Date).toLocaleString())},sheets:n.map((function(e){var t,n,r=e.table,a=e.columns,c=e.rows;return{properties:{title:r,gridProperties:{rowCount:(null!==(t=null===c||void 0===c?void 0:c.length)&&void 0!==t?t:0)+1,columnCount:a.length}},data:[{startRow:0,startColumn:0,rowData:[{values:a.map((function(e){return{userEnteredValue:{stringValue:String(e)}}}))}].concat(null!==(n=null===c||void 0===c?void 0:c.map((function(e){return{values:e.map((function(e){return{userEnteredValue:{stringValue:String(e)}}}))}})))&&void 0!==n?n:[])}]}}))});case 10:r=e.sent,a=r.body,c=JSON.parse(a),s=c.spreadsheetId,this.setSpreadsheetId(s);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(f);j.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ",j.spreadsheetSchemaKey="spreadsheetSchema",j.spreadsheetIdKey="spreadsheedId";var m=n(1),g=n(4),x=[{table:"ChemicalApplication",columns:["date","field","crop","acres","chemical","amount"]},{table:"Chemical",columns:["name"]},{table:"Field",columns:["name"]}],w=new function e(t){var n=this,r=t.RecordsProvider,a=t.Login,c=t.Setup;Object(l.a)(this,e),this.Setup=void 0,this.Login=void 0,this.provider=void 0,this.isAuthenticated=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provider.isAuthenticated();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.isConnected=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provider.isConnected();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.connect=function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provider.connect(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.disconnect=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provider.disconnect();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.login=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provider.login();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.logout=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provider.logout();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.schema=function(e){return n.provider.schema(e)},this.insert=function(){var e=Object(o.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provider.insert(t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.get=function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provider.get(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.Setup=c,this.Login=a,this.provider=r}({RecordsProvider:new j,Login:function(){var e=k().login;return Object(m.jsx)("button",{onClick:e,children:"Login"})},Setup:function(){var e=k().connect,t=Object(r.useState)(""),n=Object(g.a)(t,2),a=n[0],c=n[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{children:"Link to an existing spreadsheet"}),Object(m.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e({spreadsheetId:a})},children:[Object(m.jsxs)("label",{children:["Spreadsheet ID:"," ",Object(m.jsx)("input",{value:a,onChange:function(e){return c(e.target.value)}})]}),Object(m.jsx)("button",{type:"submit",children:"Submit"})]}),Object(m.jsx)("hr",{}),Object(m.jsx)("button",{onClick:function(){return e({schema:x})},children:"Create"})]})}}),O=w.Setup,y=w.Login,k=h()((function(e,t){return{isInitialized:!1,isAuthenticated:!1,isConnected:!1,records:w,connect:function(){var n=Object(o.a)(i.a.mark((function n(r){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t().records.connect(r);case 2:return n.t0=e,n.next=5,t().records.isConnected();case 5:n.t1=n.sent,n.t2={isConnected:n.t1},(0,n.t0)(n.t2);case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),disconnect:function(){var n=Object(o.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t().records.disconnect();case 2:return n.t0=e,n.next=5,t().records.isConnected();case 5:n.t1=n.sent,n.t2={isConnected:n.t1},(0,n.t0)(n.t2);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),initialize:function(){var n=Object(o.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=e,n.next=3,t().records.isAuthenticated();case 3:return n.t1=n.sent,n.next=6,t().records.isConnected();case 6:return n.t2=n.sent,n.t3={isInitialized:!0,isAuthenticated:n.t1,isConnected:n.t2},n.abrupt("return",(0,n.t0)(n.t3));case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),login:function(){var n=Object(o.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=e,n.next=3,t().records.login();case 3:return n.t1=n.sent,n.t2={isAuthenticated:n.t1},n.abrupt("return",(0,n.t0)(n.t2));case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),logout:function(){var n=Object(o.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=e,n.next=3,t().records.logout();case 3:return n.t1=n.sent,n.t2={isAuthenticated:n.t1},n.abrupt("return",(0,n.t0)(n.t2));case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()}})),S=function(){var e=Object(r.useState)(""),t=Object(g.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),s=Object(g.a)(c,2),u=s[0],p=s[1],h=Object(r.useState)(""),d=Object(g.a)(h,2),l=d[0],f=d[1],v=k(),b=v.records,j=v.disconnect;Object(r.useEffect)((function(){n&&b.get(n).then(p)}),[b,n]);var w=function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,b.insert(n,l.split(","));case 3:f(""),b.get(n).then(p);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{children:[Object(m.jsxs)("select",{defaultValue:"empty",onChange:function(e){return a(e.target.value)},children:[Object(m.jsx)("option",{disabled:!0,value:"empty",children:"Select a table"}),x.map((function(e){var t=e.table;return Object(m.jsx)("option",{value:t,children:t},t)}))]}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),u.map((function(e,t){return Object(m.jsx)("div",{children:e.map((function(e,t){return Object(m.jsx)("span",{children:e},t)}))},t)})),Object(m.jsx)("br",{}),Object(m.jsxs)("form",{onSubmit:w,children:[Object(m.jsx)("input",{onChange:function(e){return f(e.target.value)}}),Object(m.jsx)("button",{children:"Submit"})]}),Object(m.jsx)("br",{}),Object(m.jsx)("button",{onClick:j,children:"Disconnect"})]})},I=(n(19),function(){var e=k(),t=e.initialize,n=e.isInitialized,a=e.isAuthenticated,c=e.isConnected;return Object(r.useEffect)((function(){t()}),[t]),Object(m.jsx)("div",{className:"App",children:n?a?c?Object(m.jsx)(S,{}):Object(m.jsx)(O,{}):Object(m.jsx)(y,{}):Object(m.jsx)("div",{children:"Loading..."})})}),C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,21)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(I,{})}),document.getElementById("root")),C()}},[[20,1,2]]]);
//# sourceMappingURL=main.ca0a9d84.chunk.js.map